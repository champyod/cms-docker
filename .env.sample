# ======================
# CMS Docker Environment Configuration - VPS Deployment
# ======================
# This file contains all environment variables needed for deploying
# the Contest Management System (CMS) using Docker Compose with Portainer

# ======================
# VPS Network Configuration
# ======================
# Your VPS public IP address (used by Raspberry Pi workers to connect)
VPS_PUBLIC_IP=YOUR_VPS_PUBLIC_IP_HERE
VPS_HOSTNAME=${VPS_PUBLIC_IP}

# ======================
# Database Configuration
# ======================
POSTGRES_DB=cmsdb
POSTGRES_USER=cmsuser
POSTGRES_PASSWORD=changeme123!
POSTGRES_PUBLIC_PORT=5432

# ======================
# CMS Core Configuration
# ======================
# Secret key for web sessions (generate with: python -c 'from cmscommon import crypto; print(crypto.get_hex_random_key())')
CMS_SECRET_KEY=8e045a51e4b102ea803c06f92841a1fb
CMS_TORNADO_DEBUG=false

# ======================
# Public Port Configuration (No Domain)
# ======================
# Contest Web Server (For Participants)
CMS_CONTEST_LISTEN_ADDRESS=0.0.0.0
CMS_CONTEST_LISTEN_PORT=8888
CMS_CONTEST_PUBLIC_PORT=8888
CMS_CONTEST_COOKIE_DURATION=10800

# Admin Web Server (For Administrators) 
CMS_ADMIN_LISTEN_ADDRESS=0.0.0.0
CMS_ADMIN_LISTEN_PORT=8889
CMS_ADMIN_PUBLIC_PORT=8889
CMS_ADMIN_COOKIE_DURATION=36000

# Ranking Web Server (For Scoreboard)
CMS_RANKING_BIND_ADDRESS=0.0.0.0
CMS_RANKING_HTTP_PORT=8890
CMS_RANKING_PUBLIC_PORT=8890
CMS_RANKING_USERNAME=admin
CMS_RANKING_PASSWORD=ranking123!
CMS_RANKING_REALM=Scoreboard
CMS_RANKING_BUFFER_SIZE=100

# ======================
# CMS Service Ports (for Raspberry Pi workers)
# ======================
CMS_LOG_SERVICE_PORT=29000
CMS_RESOURCE_SERVICE_PORT=28000
CMS_SCORING_SERVICE_PORT=28500
CMS_EVALUATION_SERVICE_PORT=25000
CMS_PROXY_SERVICE_PORT=28600

# ======================
# Nginx Configuration (Optional)
# ======================
# Set to false to use direct ports instead of domain routing
USE_NGINX=false
CMS_DOMAIN=localhost
HTTP_PORT=80
HTTPS_PORT=443

# ======================
# Storage Configuration
# ======================
CMS_LOG_DIR=/opt/cms/log
CMS_CACHE_DIR=/opt/cms/cache
CMS_DATA_DIR=/opt/cms/lib
CMS_RUN_DIR=/opt/cms/run
CMS_RANKING_LOG_DIR=/opt/cms/log/ranking
CMS_RANKING_LIB_DIR=/opt/cms/lib/ranking

# ======================
# CMS System Configuration
# ======================
# Number of workers on main VPS (typically 1, more workers on Raspberry Pis)
CMS_NUM_WORKERS=1
CMS_MAX_SUBMISSION_LENGTH=100000
CMS_MAX_INPUT_LENGTH=5000000

# ======================
# Security & Admin Configuration
# ======================
# Database admin credentials (for initial setup)
DB_ROOT_PASSWORD=root_password_123!

# CMS Admin user (created during setup)
CMS_ADMIN_USERNAME=admin
CMS_ADMIN_PASSWORD=admin_password_123!

# ======================
# Future Domain Configuration
# ======================
# When you get a domain, update these:
# FUTURE_DOMAIN=your-domain.com
# USE_NGINX=true
# Then enable nginx profile in docker-compose

# ======================
# Notes for Portainer Deployment:
# ======================
# 1. Replace YOUR_VPS_PUBLIC_IP_HERE with your actual VPS IP
# 2. Change all passwords before deployment
# 3. Access URLs will be:
#    - Contest: http://VPS_IP:8888
#    - Admin: http://VPS_IP:8889
#    - Ranking: http://VPS_IP:8890
# 4. For Raspberry Pi workers, use the setup script with VPS_PUBLIC_IP
